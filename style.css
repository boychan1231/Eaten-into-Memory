:root {
    --bg-color: #1a1a2e;
    --text-color: #e0e0e0;
    --accent-color: #e94560;
    --clock-bg: #16213e;
    --card-bg: #0f3460;
    --player-bg: #2a2a40;
    --mirror-border: rgba(255, 255, 255, 0.3);
    --mirror-shine: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 50%, rgba(255,255,255,0.05) 100%);
	/* 新增：定義響應式字體大小基礎值 */
    --base-font-size: clamp(14px, 1vw, 16px);
}

body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: var(--bg-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    height: 100vh;
    overflow: hidden;
	font-size: var(--base-font-size); /* 使用變數控制基礎字體 */
}

/* --- 畫面結構 --- */
.game-wrapper {
	display: flex;
    flex-direction: column;
    height: 100vh;
    max-width: 1500px;
    width: 100%;
    margin: 0 auto;
    padding: 10px;
    box-sizing: border-box;
	overflow-y: auto;        /* 內容過多時顯示滾輪 */
    overflow-x: hidden;
}

/* --- 頂部區域 Header --- */
header {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    align-items: center;
    padding: 10px 20px;
    background-color: var(--clock-bg);
    border-radius: 8px;
    margin-bottom: 10px;
    border-bottom: 2px solid var(--accent-color);
    box-shadow: 0 4px 6px rgba(0,0,0,0.3);
}

header h1 { 
    margin: 0; 
    font-size: 1.5rem; 
    text-shadow: 0 0 5px var(--accent-color); 
    grid-column: 2;
    text-align: center;
}

.game-status {
    grid-column: 3;
    justify-self: end;
    text-align: right;
    display: flex;
    align-items: center;
    gap: 10px;
}

/* --- Tab 導航 --- */
.tab-nav {
    grid-column: 1 / span 2;
    justify-self: start;
    display: flex;
    gap: 5px;
    margin-bottom: -10px;
    padding-top: 5px;
    z-index: 50;
    position: relative;
    padding-left: 0;
}

.tab-btn {
    background-color: var(--card-bg); 
    color: var(--text-color);
    border: 1px solid var(--clock-bg);
    border-bottom: none;
    padding: 8px 15px;
    font-weight: normal;
    cursor: pointer;
    border-radius: 6px 6px 0 0;
    transition: background-color 0.3s;
}

.tab-btn:hover { background-color: #1f4287; }

.tab-btn.active {
    background-color: var(--bg-color);
    color: var(--accent-color);
    border-top: 2px solid var(--accent-color);
    border-left: 1px solid #333;
    border-right: 1px solid #333;
    font-weight: bold;
    margin-top: -1px;
}

.tab-wrapper {
    flex: 1;
    display: flex;
    flex-direction: column;
    padding-top: 10px;
    position: relative;
    overflow: hidden;
}

.tab-content {
    display: none;
    width: 100%;
    height: 100%;
    overflow-y: auto;
}

.tab-content.active-tab {
    display: block;
    flex: 1;
}

/* --- 按鈕與開關 --- */
button {
    background-color: var(--accent-color);
    color: white;
    border: none;
    padding: 8px 16px;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.3s;
}
button:hover:not(:disabled) { filter: brightness(1.1); }
button:disabled { background-color: #555; cursor: not-allowed; }

.toggle-switch {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    font-size: 0.9rem;
    color: #ccc;
    user-select: none;
}
.toggle-switch input { display: none; }
.slider {
    position: relative;
    width: 36px;
    height: 20px;
    background-color: #555;
    border-radius: 20px;
    transition: .4s;
}
.slider:before {
    position: absolute;
    content: "";
    height: 14px;
    width: 14px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    border-radius: 50%;
    transition: .4s;
}
input:checked + .slider { background-color: var(--accent-color); }
input:checked + .slider:before { transform: translateX(16px); }

/* --- 規則與設定頁 --- */
#rules-content, #settings-content {
    background-color: var(--bg-color);
    padding: 20px;
    border-radius: 8px;
    border: 1px solid #333;
}
.setting-item { margin-bottom: 15px; }

/* --- 主遊戲區域 (鐘面 + 日誌) --- */
.main-area {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* 自動填滿分欄 */
    gap: 15px;
    width: 100%;
}

/* --- 鐘面區域 --- */
.clock-section {
    width: min(500px, 90vw); 
    height: min(500px, 90vw);
    aspect-ratio: 1 / 1;
	margin: 50px auto 20px auto;;
}

#clock-face {
    position: relative;
    width: 100%;
    height: 100%;
	
	/* 設定背景圖片 */
    /* 請將 'clock-bg.png' 換成你的檔名 */
    background-image: url('clock-bg.png');
	/* 圖片置中 */
    background-position: center;
    /* 不重複 */
    background-repeat: no-repeat;
	background-color: transparent !important; /* 強制背景透明 */
	background-size: contain;
}

.clock-center {
    position: absolute;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    width: 280px; height: 280px;
    border-radius: 50%;
    background-color: var(--bg-color);
    box-shadow: 0 0 20px rgba(0,0,0,0.8);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px; 
    z-index: 30;
}

/* 鐘面格子 */
.clock-spot {
    position: absolute;
    width: 70px; height: 70px;
    background: transparent;
    background-image: none;
    border: 2px solid rgba(255, 255, 255, 0.15);
    border-radius: 50%;
    box-shadow: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 0.8rem;
    transform: translate(-50%, -50%);
    transition: all 0.3s;
    backdrop-filter: none;
    z-index: 10;
}

.clock-spot.active-round {
    border-color: var(--accent-color);
    box-shadow: 0 0 10px rgba(233, 69, 96, 0.4);
    transform: translate(-50%, -50%) scale(1.1);
    z-index: 15;
}

.active-round-arrow {
    position: absolute;
    width: 0; height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-top: 25px solid var(--accent-color);
    z-index: 20;
    filter: drop-shadow(0 0 5px var(--accent-color));
    animation: arrowFloat 1s ease-in-out infinite alternate;
    pointer-events: none;
}
@keyframes arrowFloat {
    from { opacity: 0.8; transform: translate(-50%, -50%) rotate(var(--arrow-rotation)) translateY(0); }
    to { opacity: 1; transform: translate(-50%, -50%) rotate(var(--arrow-rotation)) translateY(-10px); }
}

/* 鐘面上卡牌預覽 */
.clock-spot .card-preview {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 34px; height: 40px;
    padding: 2px 0;
    line-height: 1.0;
    background: rgba(255, 255, 255, 0.9);
    color: #000;
    border-radius: 4px;
    font-weight: bold;
    box-shadow: 0 2px 4px rgba(0,0,0,0.5);
    z-index: 2;
}
.cp-num { font-size: 0.72rem; font-weight: 800; }
.cp-age { font-size: 0.52rem; font-weight: 700; opacity: 0.9; }
.cp-star{ font-size: 0.65rem; font-weight: 900; }

.clock-spot .tokens {
    position: absolute;
    bottom: -5px;
    display: flex;
    justify-content: center;
    width: 100%;
    flex-wrap: wrap;
    gap: -5px;
}
.token {
    width: 14px; height: 14px;
    border-radius: 50%;
    border: 2px solid #fff;
    box-shadow: 0 0 5px rgba(0,0,0,0.8);
    transition: transform 0.2s;
}
.token:hover { transform: scale(1.5); z-index: 20; }

/* 鐘面中心的小時卡 */
.clock-center .drawn-hour-card {
    width: 50px; height: 75px;
    background: linear-gradient(to bottom right, #f7f7f7, #ddd);
    color: #000;
    border-radius: 4px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.6);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 1rem;
    font-weight: bold;
    line-height: 1.05;
}
.drawn-hour-card.precious { border: 3px solid gold; box-shadow: 0 0 10px gold; }
.drawn-hour-card .hour-num { font-size: 1.05rem; font-weight: 800; }
.drawn-hour-card .hour-age { font-size: 0.62rem; font-weight: 600; color: #222; margin-top: 2px; }
.drawn-hour-card .hour-star { font-size: 0.9rem; margin-top: 2px; }
.drawn-hour-card.clickable {
    cursor: pointer;
    border: 3px solid #e94560;
    box-shadow: 0 0 15px rgba(233, 69, 96, 1);
    transform: scale(1.05);
}

.hour-choice-tip {
    position: absolute;
    top: 20%; left: 0; width: 100%;
    text-align: center;
    font-size: 1.1rem;
    font-weight: bold;
    color: #ffd27f;
    text-shadow: 0 2px 4px rgba(0,0,0,0.8);
    z-index: 20;
    pointer-events: none;
    animation: tipPulse 1s infinite alternate;
}
@keyframes tipPulse {
    from { opacity: 0.8; transform: translateY(0); }
    to { opacity: 1; transform: translateY(-3px); }
}

/* --- 側邊欄與日誌 --- */
.log-section {
    flex: none; 
    width: 100%;
    background-color: var(--player-bg);
    border-radius: 8px;
    display: flex;
    flex-direction: column;
    max-height: 550px;
}
.log-section h3 { padding: 10px; margin: 0; background: #222; border-radius: 8px 8px 0 0; }
#game-log-container {
    flex: 1;
    overflow-y: auto;
    padding: 10px;
    font-size: 0.9rem;
    scrollbar-width: thin;
    scrollbar-color: #444 #222;
}

/* 日誌列表容器 */
#log-list { 
    list-style: none; 
    padding: 0; 
    margin: 0; 
}

/* 單條日誌樣式：卡片化設計 */
#log-list li { 
    position: relative;
    margin-bottom: 4px;              /* 項目間保留微小空隙 */
    padding: 5px 6px;              /* 增加內距，讓文字呼吸 */
    border-bottom: 1px solid rgba(255, 255, 255, 0.1); /* 柔和的底線 */
    background-color: rgba(0, 0, 0, 0.2); /* 深色背景，與面板區隔 */
    border-left: 4px solid #555;     /* 左側視覺引導線 (灰色預設) */
    font-size: 0.9rem;
    line-height: 1.5;
    color: #ccc;
    transition: background-color 0.2s; /* 懸停時平滑過渡 */
}

/* 斑馬紋效果 (Zebra Striping)：區分單雙行，建立閱讀節奏 */
#log-list li:nth-child(even) {
    background-color: rgba(255, 255, 255, 0.03);
}

/* 最新訊息高亮：鎖定最後一條，給予強烈提示 */
#log-list li:last-child {
    border-left-color: var(--accent-color); /* 左側變紅 */
    background: linear-gradient(90deg, rgba(233, 69, 96, 0.15) 0%, rgba(0,0,0,0) 100%); /* 紅色漸層光暈 */
    color: #fff;
    font-weight: bold;
    border-bottom: none;
}

/* 滑鼠懸停輔助：當滑鼠滑過時打亮，方便回頭閱讀 */
#log-list li:hover {
    background-color: rgba(255, 255, 255, 0.1);
    border-left-color: #ffd27f; /* 金色引導線 */
    color: #fff;
}




/* 右側資訊面板群組 */
.side-panel-group {
    flex: 0 0 320px;
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.log-side-info {
    width: 100%;
    background: rgba(15, 52, 96, 0.9);
    border: 2px solid var(--accent-color);
    border-radius: 8px;
    padding: 10px;
    box-shadow: 0 0 10px rgba(233, 69, 96, 0.3);
    box-sizing: border-box;
}

#deck-info {
    height: 120px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: default;
    user-select: none;
}
.deck-title { font-size: 0.8rem; color: #bbb; margin-bottom: 2px; }
.deck-count { font-size: 1.5rem; font-weight: bold; color: white; }

/* 出牌列表與歷史記錄 */
#played-cards-panel {
    height: auto;
    min-height: 220px;
    position: sticky; top: 10px; z-index: 2;
}
.panel-switcher {
    display: flex; gap: 5px; margin-bottom: -5px;
}
.switch-btn {
    flex: 1;
    background-color: rgba(15, 52, 96, 0.5);
    border: 1px solid #444;
    color: #aaa;
    font-size: 0.85rem;
    padding: 6px 0;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.3s;
}
.switch-btn:hover { background-color: rgba(15, 52, 96, 0.8); color: #fff; }
.switch-btn.active {
    background-color: var(--accent-color);
    color: white;
    font-weight: bold;
    box-shadow: 0 0 8px rgba(233, 69, 96, 0.4);
}

#played-cards-list, #player-history-list {
    max-height: 400px;
    overflow: visible;
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 10px;
}
.played-card-row {
    display: flex; justify-content: space-between; align-items: center;
    padding: 8px 5px; border-bottom: 1px solid rgba(255, 255, 255, 0.15);
    font-size: 1.1rem;
}
.p-name {
    flex: 1; font-size: 1.1rem; font-weight: bold; margin-right: 10px;
    white-space: nowrap; overflow: visible;
}
.p-val {
    font-family: 'Courier New', Courier, monospace;
    font-weight: bold; color: #fff;
    background: rgba(0, 0, 0, 0.6);
    font-size: 1.3rem; padding: 4px 12px;
    border-radius: 6px; border: 1px solid #777;
    min-width: 40px; text-align: center;
}
.played-placeholder {
    font-size: 1rem; padding: 15px 5px; text-align: center; opacity: 0.8;
}

/* 歷史記錄小元件 */
.player-history-row {
    display: flex; align-items: center; justify-content: space-between; gap: 8px;
    padding: 4px 2px; border-bottom: 1px solid rgba(255,255,255,0.08);
}
.player-history-name {
    min-width: 92px; font-size: 0.9rem; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}
.player-history-cards {
    display: grid;
	grid-template-columns: repeat(6, 1fr);
	gap: 4px;
    width: 100%; 
	max-width: 210px; 
	margin-left: auto;
}
.minute-chip {
    width: auto; height: 24px;
    border-radius: 4px;
    display: inline-flex; align-items: center; justify-content: center;
    background: rgba(255,255,255,0.08);
    color: rgba(255,255,255,0.9);
    font-size: 0.85rem; font-weight: bold;
}
.minute-chip.empty { opacity: 0.35; }


/* --- 人類玩家區域 (整合重構版) --- */
.human-area {
    display: flex;
    flex-direction: column;
    gap: 15px;
    background-color: #2b1d30; /* 深紫色背景 */
    border-top: 3px solid #6b4c7b;
    padding: 15px 20px;
    margin-top: 10px;
    border-radius: 8px;
    box-shadow: 0 -5px 20px rgba(0, 0, 0, 0.5);
}

/* 上層：標題與數據列 */
.human-top-bar {
    display: flex;
    flex-direction: column;
    gap: 10px;
    width: 100%;
}
.human-top-bar h4 {
    margin: 0; color: #fff; font-size: 1.1rem; font-weight: bold;
    text-shadow: 0 0 5px rgba(233, 69, 96, 0.5);
}

.human-stats-row {
    display: flex; flex-wrap: wrap; gap: 8px; align-items: center;
}
.human-stats-row div {
    background: #1f1424;
    border: 1px solid #4a3b52;
    border-radius: 4px;
    padding: 5px 12px;
    color: #dccae5; font-size: 0.95rem;
    display: flex; align-items: center; white-space: nowrap;
}
.human-stats-row span {
    color: #ff6b6b; font-weight: bold; margin-left: 6px; font-size: 1.1rem;
}

/* 人類玩家分頁 */
.human-tabs {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.human-tab-nav {
    display: flex;
    gap: 6px;
    flex-wrap: wrap;
}

.human-tab-btn {
    background-color: #1f1424;
    color: #dccae5;
    border: 1px solid #4a3b52;
    padding: 6px 14px;
    border-radius: 6px;
    cursor: pointer;
    font-weight: 600;
}

.human-tab-btn.active {
    background-color: #2d1a36;
    color: #ffd27f;
    border-color: #6b4c7b;
    box-shadow: 0 0 0 1px rgba(255, 210, 127, 0.3);
}

.human-tab-panel {
    display: none;
}

.human-tab-panel.active {
    display: block;
}

/* 下層：遊戲操作區 (橫向排列：左手牌、右控制) */
.human-play-row {
    display: flex;
    flex-direction: row;
    align-items: flex-start;
    gap: 20px;
    width: 100%;
}

/* 左側：手牌區 */
.hand-display {
    flex: 1; /* 自動填滿 */
    display: flex; 
	flex-wrap: wrap; 
	gap: 8px;
    padding: 5px 0;
	justify-content: flex-end; /* 將手牌排列方式改為靠右對齊 */
}

/* 進化分頁雙欄 */
.evolution-tab-body {
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 12px;
    align-items: start;
}

.evolution-left {
    background: #1f1424;
    border: 1px solid #4a3b52;
    border-radius: 10px;
    padding: 12px;
    height: 220px;
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.evolution-panel-title {
    font-weight: bold;
    color: #ffd27f;
    text-shadow: 0 0 6px rgba(255, 210, 127, 0.3);
}

.hour-collection-list {
    flex: 1;
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    overflow-y: auto;
    padding-right: 4px;
}

.hour-collection-card {
    min-width: 42px;
    padding: 6px 8px;
    border-radius: 6px;
    background: rgba(255, 255, 255, 0.08);
    border: 1px solid rgba(255, 255, 255, 0.12);
    text-align: center;
    font-weight: bold;
    color: #fff;
    box-shadow: inset 0 0 6px rgba(0,0,0,0.35);
}

.hour-collection-card.precious {
    border-color: #ffd27f;
    color: #ffd27f;
}

.hour-collection-placeholder {
    opacity: 0.6;
    font-size: 0.9rem;
}

.minute-card {
    width: 55px; height: 80px;
    font-size: 1.3rem; font-weight: 800;
    background-color: #e0e0e0;
    color: #333;
    border: 2px solid #888; border-radius: 6px;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    cursor: pointer; user-select: none;
    box-shadow: 0 4px 0 #666;
    transition: transform 0.1s, background-color 0.2s;
}
.minute-card:hover { transform: translateY(-3px); background-color: #fff; box-shadow: 0 6px 0 #666; }
.minute-card.selected { 
    background-color: #fff; border-color: #e94560;
    transform: translateY(2px); box-shadow: 0 2px 0 #b02a40;
}
.card-gear { font-size: 0.75rem; color: #555; margin-top: 5px; }
.card-gear::after { content: '⚙'; font-size: 0.7rem; }

/* 右側：控制區 (固定寬度，垂直排列) */
.hand-controls {
    flex: 0 0 280px;
    width: 280px;
    display: flex; flex-direction: column; gap: 10px;
}
.play-control-block {
    display: flex;
    flex-direction: column;
    gap: 10px;
    background: #151019;
    border: 1px solid #4a3b52;
    border-radius: 6px;
    padding: 12px;
}

/* 進化面板 (黑色區塊) */
#evolution-progress-area, .progress-area {
    background-color: #151019;
    border: 1px solid #4a3b52;
    border-radius: 6px;
    padding: 12px;
    color: #ccc; font-size: 0.85rem;
    display: flex; flex-direction: column; gap: 8px;
}

/* 目標身份與選單 */
.target-role-header {
    margin-bottom: 5px;
    border-bottom: 1px solid #333;
    padding-bottom: 8px;
}
.target-role-label {
    color: #ffd27f; font-weight: bold; display: block; margin-bottom: 4px;
}
.target-role-select {
    width: 100%; background: #333; color: #fff;
    border: 1px solid #555; padding: 4px; border-radius: 4px;
}
.target-role-hint {
    font-size: 0.75rem; color: #888; float: right; font-weight: normal;
}

/* 進化條件列表 */
.condition-row {
    display: flex; align-items: flex-start; gap: 8px;
    line-height: 1.4; color: #aaa; margin-bottom: 6px;
}
.condition-icon {
    flex-shrink: 0; width: 14px; height: 14px;
    background: #c8a2c8; opacity: 0.5; border-radius: 2px; margin-top: 3px;
    display: flex; align-items: center; justify-content: center;
}
.condition-row.met .condition-icon {
    background: #e94560; opacity: 1; box-shadow: 0 0 5px #e94560;
}
.condition-row.met { color: #fff; }

/* 按鈕樣式 */
.hand-controls button {
    width: 100%;
    padding: 12px;
    border-radius: 4px;
    border: none;
    font-weight: bold;
    font-size: 1rem;
    cursor: pointer;
    text-shadow: 0 1px 2px rgba(0,0,0,0.3);
}

#confirm-move-btn { background-color: #555; color: #ccc; margin-top: 5px; }
#confirm-move-btn:not(:disabled) { background-color: #4CAF50; color: white; }

#next-step-btn { background-color: #e94560; color: white; }
#next-step-btn:disabled { background-color: #333; color: #666; cursor: not-allowed; }

/* 秒針按鈕 */
#seconds-ability-controls { margin: 5px 0; display: flex; flex-direction: column; gap: 5px; }
#seconds-ability-controls button {
    background: rgba(0,0,0,0.35); border: 1px solid rgba(255,255,255,0.25);
    padding: 8px; font-size: 0.9rem;
}

/* --- 彈窗 Overlay --- */
.modal-overlay {
    position: fixed; inset: 0; background: rgba(0,0,0,0.65);
    display: none; align-items: center; justify-content: center; z-index: 9999;
}
.modal {
    width: min(420px, calc(100vw - 24px));
    background: rgba(25, 25, 25, 0.98);
    border: 1px solid rgba(255,255,255,0.18);
    border-radius: 14px; padding: 16px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.45);
}
.modal-title { font-size: 1.05rem; font-weight: 700; margin-bottom: 8px; color: #fff; }
.modal-desc { font-size: 0.9rem; opacity: 0.9; margin-bottom: 12px; color: #ddd; }
.modal-actions { display: flex; gap: 10px; }
.modal-actions button {
    flex: 1; padding: 12px 0; border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.25);
    background: rgba(0,0,0,0.35); color: #fff; font-size: 1.1rem; cursor: pointer;
}
.modal-actions button:hover { background: rgba(255,255,255,0.10); }

/* --- AI 玩家卡片 --- */
.players-grid {
    height: 140px;
	display: flex;
    gap: 10px;
    margin-top: 10px;
    overflow-x: auto;
}
.player-card {
    flex: 1; min-width: 180px;
    background-color: var(--card-bg);
    border: 1px solid #444; border-radius: 6px; padding: 10px;
    display: flex; flex-direction: column; position: relative;
}
.player-card.ejected { opacity: 0.5; border: 2px solid red; }
.player-card h4 { margin: 0 0 5px 0; font-size: 1rem; color: #8ec5fc; }

.player-stats {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 6px 10px;
    font-size: 0.85rem;
    line-height: 1.3;
	height: auto; /* 若要固定高度可設例如 400px */
}

.role-badge { 
    position: absolute; top: 5px; right: 5px; 
    font-size: 0.7rem; background: #444; padding: 2px 5px; border-radius: 4px; 
}

/* 響應式調整 */
@media (max-width: 900px) {
    .human-play-row { flex-direction: column; }
    .hand-controls { width: 100%; flex: none; }
}

/* --- 新增：已收集小時卡 (文字列表樣式) --- */

/* 列表容器微調 */
#human-hour-collection {
    display: flex;
    flex-direction: column;
    gap: 4px; /* 行距 */
    padding-top: 5px;
}

/* 每一行的樣式 */
.collection-text-row {
    font-size: 0.9rem;
    line-height: 1.4;
    border-bottom: 1px dashed rgba(255, 255, 255, 0.1); /* 淡淡的分隔線 */
    padding-bottom: 2px;
}

/* 標籤 (少年/青年/中年) */
.col-label {
    color: #aaa;       /* 灰色標籤 */
    font-weight: normal;
    margin-right: 2px;
}

/* 數值內容 */
.col-values {
    color: #fff;       /* 亮白數字 */
    font-weight: bold;
    font-family: 'Courier New', monospace; /* 等寬字體讓數字更清楚 */
    letter-spacing: 1px;
}
/* --- 版面調整：進化面板移至日誌區 --- */

/* 1. 調整日誌區佈局：讓日誌列表 (flex: 1) 自動佔據剩餘空間，進化面板在底部固定 */
.log-section {
    display: flex;
    flex-direction: column;
    /* 確保高度足夠容納兩者，但不超過畫面 */
    height: 100%; 
    max-height: 600px; 
}

/* 日誌容器：自動伸縮，顯示捲軸 */
#game-log-container {
    flex: 1; 
    min-height: 100px; /* 至少保留一點高度給日誌 */
	max-height: 360px;
    border-bottom: 1px solid #444; /* 與下方的進化面板做區隔 */
}

/* 2. 進化面板 (在日誌區內) 的微調 */
#evolution-progress-area {
    flex: 0 0 auto; /* 高度由內容決定，不伸縮 */
    border-radius: 3px;
    font-size: 0.85rem;
}

/* 3. 修復原本的進化分頁 (現在變寬了) */
.evolution-tab-body {
    display: block !important; /* 覆蓋原本的 grid */
}
#human-hour-collection {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}
/* 讓文字列表橫向排列更整齊 */
.collection-text-row {
    width: 100%;
    padding: 4px 0;
}

/* --- style.css 新增：日誌逐條顯示動畫 --- */
.log-entry-new {
    animation: logFadeIn 0.5s ease-out forwards;
    opacity: 0; /* 初始透明，由動畫變為不透明 */
    border-bottom: 1px solid #444;
    padding-bottom: 4px;
    margin-bottom: 6px;
}

@keyframes logFadeIn {
    from {
        opacity: 0;
        transform: translateY(5px); /* 從下方滑入 */
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* --- 新增：進化後能力面板樣式 --- */
.evo-ability-panel {
    display: flex;
    flex-direction: column;
    gap: 8px;
    text-align: center;
}

.evo-role-title {
    font-size: 1rem;
    font-weight: bold;
    color: #ffd27f;
    border-bottom: 1px solid #444;
    padding-bottom: 5px;
    margin-bottom: 5px;
}

.evo-btn {
    width: 100%;
    padding: 10px;
    border-radius: 6px;
    border: none;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.2s;
    color: #000;
    font-size: 0.95rem;
    position: relative;
}
.evo-btn:disabled {
    background-color: #555 !important;
    color: #888 !important;
    cursor: not-allowed;
    box-shadow: none;
}
.evo-btn:active {
    transform: translateY(2px);
}

.evo-desc {
    font-size: 0.8rem;
    color: #aaa;
    margin-top: 2px;
}

/* --- 新增：鐘面卡牌堆疊查看器 (Stack Inspector) --- */
.stack-inspector {
    display: none; /* 預設隱藏 */
    position: absolute;
    bottom: 110%; /* 顯示在格子上方 */
    left: 50%;
    transform: translateX(-50%);
    background: rgba(20, 25, 40, 0.95);
    border: 1px solid #777;
    border-radius: 6px;
    padding: 8px;
    min-width: 110px;
    z-index: 100; /* 確保浮在最上層 */
    box-shadow: 0 4px 15px rgba(0,0,0,0.8);
    pointer-events: none; /* 讓滑鼠點擊穿透，不會擋到操作 */
    text-align: center;
    backdrop-filter: blur(4px);
}

/* 當滑鼠懸停在鐘面格子時顯示 */
.clock-spot:hover .stack-inspector {
    display: flex;
    flex-direction: column;
    animation: popupFadeIn 0.2s ease-out;
}

.stack-title {
    font-size: 0.75rem;
    color: #aaa;
    border-bottom: 1px solid #444;
    padding-bottom: 4px;
    margin-bottom: 4px;
    font-weight: bold;
}

.stack-item {
    font-size: 0.85rem;
    padding: 3px 0;
    color: #ddd;
    border-bottom: 1px dashed rgba(255,255,255,0.1);
    line-height: 1.2;
}
.stack-item:last-child { border-bottom: none; }

/* 珍貴卡特別標示 */
.stack-item.precious { 
    color: #ffd27f; 
    font-weight: bold; 
    text-shadow: 0 0 2px orange; 
}
.stack-item .age-tag { 
    font-size: 0.7em; 
    color: #888; 
    margin-left: 2px; 
    vertical-align: middle;
}

@keyframes popupFadeIn {
    from { opacity: 0; transform: translate(-50%, 5px); }
    to { opacity: 1; transform: translate(-50%, 0); }
}

/* --- 修正：讓滑鼠指到的格子層級最高，避免視窗被遮擋 --- */
.clock-spot:hover {
    z-index: 200 !important; /* 強制壓過其他格子(10)、中心(30)與箭頭(20) */
}

/* --- 新增：數值變動漂浮文字 (Floating Text) --- */
@keyframes floatUpFade {
    0% { transform: translateY(0) scale(1); opacity: 1; }
    50% { transform: translateY(-20px) scale(1.2); opacity: 1; }
    100% { transform: translateY(-40px) scale(1); opacity: 0; }
}

.floating-text {
    position: absolute;
    top: 0;
    left: 50%; /* 預設置中 */
    transform: translateX(-50%);
    font-weight: 900;
    font-size: 1.4rem;
    pointer-events: none; /* 讓點擊穿透 */
    animation: floatUpFade 1.5s ease-out forwards;
    z-index: 999;
    text-shadow: 0 0 3px black, 0 0 5px rgba(0,0,0,0.5);
    white-space: nowrap;
}

/* --- 新增：數值變動漂浮文字 (Floating Text) --- */
@keyframes floatUpFade {
    0% { 
        opacity: 1;
        transform: translate(-50%, 0) scale(1); /* -50% 是為了水平置中 */
    }
    50% { 
        opacity: 1;
        transform: translate(-50%, -25px) scale(1.2); 
    }
    100% { 
        opacity: 0;
        transform: translate(-50%, -50px) scale(1); 
    }
}

.floating-text {
    position: fixed; /* ✅ 改用 fixed，無視容器邊框，直接浮在螢幕最上層 */
    top: 0; left: 0;
    pointer-events: none;
    z-index: 9999; /* 確保蓋過所有視窗 */
    font-weight: 900;
    font-size: 1.5rem;
    text-shadow: 2px 2px 0px #000, -1px -1px 0 #000; /* 加上黑邊讓文字更明顯 */
    white-space: nowrap;
    animation: floatUpFade 1.8s ease-out forwards;
}

/* --- 新增：時之惡索命紅線 (SVG) --- */
.connection-lines-svg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none; /* 讓點擊穿透 */
    z-index: 5; /* 在背景之上，但在卡片/數字之下 */
    overflow: visible;
}

/* 紅線樣式 */
.sin-line {
    stroke: #ff4757;        /* 鮮紅色 */
    stroke-width: 4;        /* 線條粗細 */
    stroke-dasharray: 10, 10; /* 虛線間隔 */
    filter: drop-shadow(0 0 5px #ff4757); /* 發光效果 */
    animation: dashMove 1s linear infinite; /* 流動動畫 */
    opacity: 0.8;
}

@keyframes dashMove {
    from { stroke-dashoffset: 20; }
    to { stroke-dashoffset: 0; }
}

/* --- 新增：防禦護盾特效 (Suggestion C) --- */
.shield-indicator {
    position: absolute;
    top: -8px;
    left: -8px;
    font-size: 1.6rem;
    filter: drop-shadow(0 0 5px #00d2d3); /* 青色光暈 */
    animation: shieldFloat 2s ease-in-out infinite;
    z-index: 25;
    cursor: help;
}

/* 人類玩家區域的護盾 (調整為行內顯示) */
.human-top-bar .shield-indicator {
    position: static;
    display: inline-block;
    vertical-align: middle;
    margin-left: 8px;
    font-size: 1.3rem;
    animation: none; /* 人類區不需要浮動，避免干擾閱讀 */
    filter: drop-shadow(0 0 3px #00d2d3);
}

@keyframes shieldFloat {
    0%, 100% { transform: translateY(0) scale(1); }
    50% { transform: translateY(-4px) scale(1.1); }
}

/* style.css */

/* ... (原有代碼) ... */

/* ✅ 新增：右側積分榜樣式 */
#score-list {
    display: flex;
    flex-direction: column;
    gap: 4px;
    padding-top: 5px;
}

.score-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 0.9rem;
    padding: 3px 5px;
    border-radius: 4px;
    background: rgba(255, 255, 255, 0.05);
}

/* 第一名高亮 */
.score-row.leader {
    background: rgba(255, 210, 127, 0.15);
    border: 1px solid rgba(255, 210, 127, 0.3);
}

.score-name {
    font-weight: bold;
}

.score-val {
    font-family: 'Courier New', monospace;
    font-weight: bold;
    color: #fff;
}

.score-row.leader .score-val {
    color: #ffd27f;
    text-shadow: 0 0 5px rgba(255, 210, 127, 0.5);
}

#deck-info {
    /* 修改 display 為 flex 以支援左右並排 */
    display: flex !important; 
    flex-direction: row !important;
    align-items: center;
    justify-content: space-around;
    height: 100px; /*稍微調整高度*/
    padding: 5px 0;
}

.info-block {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex: 1;
}

.info-divider {
    width: 1px;
    height: 60%;
    background-color: rgba(255, 255, 255, 0.2);
}

/* 讓標題字稍微小一點以適應並排 */
#deck-info .deck-title {
    font-size: 0.75rem;
    margin-bottom: 5px;
}

/* 讓數字大一點 */
#deck-info .deck-count {
    font-size: 1.3rem;
	font-weight: bold;
    color: white;
    white-space: nowrap; /* 確保不換行 */
}

/* ✅ 新增：鐘面底圖樣式 */
.clock-bg-img {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: contain; /* 保持圖片比例 */
    z-index: 0;          /* ✅ 重點：設為 0，確保在紅線(5)和格子(10)之下 */
    opacity: 0.8;        /* 可選：調整透明度讓上面的元件更清楚 */
}

/* --- 1. 全域背景紋理 --- */
body {
    /* 原本的底色 */
    background-color: var(--bg-color);
    
    /* CSS 繪製的微弱網格圖 */
    background-image: 
        linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
        linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
    
    /* 網格大小 */
    background-size: 30px 30px;
    
    /* 讓背景稍微暗一點，突顯前景 */
    background-blend-mode: overlay;
}

/* --- 2. 鐘面中心：能量核心 (Magic Core) --- */
.clock-center {
    /* 深邃的中心底色 */
    background-color: #0f0c15; 
    
    /* 多層漸層模擬魔法陣 */
    background-image: 
        /* 最內層的亮光 */
        radial-gradient(circle, rgba(233, 69, 96, 0.8) 0%, transparent 40%),
        /* 內圈環 */
        radial-gradient(circle, transparent 45%, var(--accent-color) 46%, transparent 47%),
        /* 外圈環 */
        radial-gradient(circle, transparent 55%, #ffd27f 56%, transparent 57%),
        /* 旋轉的光暈感 */
        conic-gradient(from 0deg, transparent 0%, rgba(233, 69, 96, 0.1) 25%, transparent 50%, rgba(255, 210, 127, 0.1) 75%, transparent 100%);
    
    border: 2px solid #333;
    box-shadow: 0 0 30px rgba(233, 69, 96, 0.2); /* 增加外發光 */
}

/* --- 3. 分鐘卡：金屬紋理 --- */
.minute-card {
    /* 銀灰色金屬質感 */
    background-color: #dcdcdc;
    
    /* 斜向紋理 */
    background-image: repeating-linear-gradient(
        45deg,
        rgba(0, 0, 0, 0.05) 0px,
        rgba(0, 0, 0, 0.05) 2px,
        transparent 2px,
        transparent 5px
    );
    border-color: #999;
}

/* 珍貴小時卡：黃金質感 */
.drawn-hour-card.precious, .stack-item.precious {
    /* 金色漸層底 */
    background: linear-gradient(135deg, #ffd700 0%, #ffec8b 50%, #d4af37 100%);
    color: #4a3b00; /* 深色文字讓閱讀更清楚 */
    border: 2px solid #fff;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
}

/* --- 4. 資源圖示 CSS 繪製 --- */

/* 齒輪 (Gear) 替代圖示 */
.icon-gear-css {
    display: inline-block;
    width: 16px; height: 16px;
    background: #ccc;
    border-radius: 50%;
    border: 2px dashed #555; /* 虛線邊框模擬齒輪 */
    vertical-align: middle;
    margin-right: 4px;
    box-shadow: 0 0 2px #fff;
}

/* 護盾 (Shield) 替代圖示 */
.icon-shield-css {
    display: inline-block;
    width: 14px; height: 16px;
    background: linear-gradient(to bottom, #00d2d3, #008c8c);
    border-radius: 0 0 50% 50%; /* 下半圓模擬盾牌 */
    border-top: 2px solid #fff;
    vertical-align: middle;
    margin-right: 4px;
}

/* Mana (Energy) 替代圖示 */
.icon-mana-css {
    display: inline-block;
    width: 14px; height: 14px;
    background: radial-gradient(circle, #ff9ff3 30%, #f368e0 90%);
    border-radius: 50%;
    box-shadow: 0 0 5px #f368e0;
    vertical-align: middle;
    margin-right: 4px;
}

/* --- 5. 角色頭像 Placeholder --- */

/* 基礎頭像圓框 */
.avatar-circle {
    width: 40px; height: 40px;
    border-radius: 50%;
    border: 2px solid rgba(255,255,255,0.3);
    margin-right: 10px;
    display: inline-block;
    vertical-align: middle;
    background-size: cover;
    box-shadow: 0 0 10px rgba(0,0,0,0.5);
}

/* 時魔 (Time Demon) - 紅黑漸層 */
.avatar-demon {
    background: radial-gradient(circle at 30% 30%, #ff6b6b, #550000);
}

/* 時之惡 (Sin) - 金紫漩渦 */
.avatar-sin {
    background: conic-gradient(#feca57, #6a0572, #feca57);
}

/* 受詛者 (Cursed) - 藍灰陰鬱 */
.avatar-scz {
    background: linear-gradient(180deg, #54a0ff 0%, #222 100%);
}

/* 進化後：時針/分針/秒針 - 對應霓虹色 */
.avatar-evo-hour { background: radial-gradient(circle, #ff9ff3, #550055); }
.avatar-evo-min  { background: radial-gradient(circle, #f368e0, #440044); }
.avatar-evo-sec  { background: radial-gradient(circle, #00d2d3, #004444); }